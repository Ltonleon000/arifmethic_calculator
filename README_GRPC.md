# gRPC-интеграция для распределённого калькулятора

В этой версии взаимодействие между агентом и оркестратором переведено на gRPC.

## Шаг 1: Схема взаимодействия (api.proto)

Файл `api.proto` описывает два метода:
- `GetTask` — агент запрашивает задачу у оркестратора
- `SendResult` — агент отправляет результат задачи

## Шаг 2: Генерация Go-кода

Для генерации gRPC-кода используйте:

```
protoc --go_out=. --go-grpc_out=. api.proto
```

Понадобятся пакеты:
- `google.golang.org/protobuf/cmd/protoc-gen-go`
- `google.golang.org/grpc/cmd/protoc-gen-go-grpc`

Установка:
```
go install google.golang.org/protobuf/cmd/protoc-gen-go@latest
go install google.golang.org/grpc/cmd/protoc-gen-go-grpc@latest
```

## Шаг 3: Запуск gRPC-сервера (оркестратор)
- Оркестратор запускает gRPC-сервер на порту (например, 50051)
- Реализует методы GetTask и SendResult

## Шаг 4: Запуск gRPC-клиента (агент)
- Агент подключается к gRPC-серверу оркестратора
- Получает задачи и отправляет результаты через gRPC

## Пример запуска

1. Сгенерируйте код из proto:
   ```
   protoc --go_out=. --go-grpc_out=. api.proto
   ```
2. Запустите оркестратор:
   ```
   go run ./cmd/orchestrator/main.go
   ```
3. Запустите агента:
   ```
   go run ./cmd/agent/main.go
   ```

## Важно
- Старые HTTP ручки для агентов можно удалить или оставить для совместимости.
- Для полноценной работы потребуется обновить оба компонента (оркестратор и агент) на использование gRPC.

---

Если нужно — могу сразу внедрить сервер/клиентную часть на Go и обновить инструкции по запуску.
